// Copyright 2014-2020 VintaSoft Ltd. All rights reserved.
// This software is protected by International copyright laws.
// Any copying, duplication, deployment, redistribution, modification or other
// disposition hereof is STRICTLY PROHIBITED without an express written license
// granted by VintaSoft Ltd. This notice may not be removed or otherwise
// altered under any circumstances.
// This code may NOT be used apart of the VintaSoft product.
var Vintasoft;
(function(r){if(void 0==r.Shared)throw Error("Vintasoft.Shared is not found.");if("1.7.0.3"!==r.version)throw Error("Wrong version of Vintasoft.Shared script.");r.Twain=r.Twain||(r.Twain={});(function(e){e.version="11.0.9.1";var b=r.Shared,v=b.EnumGenerator.create([{None:0},{Get:1},{GetDefault:2},{GetCurrent:4}],!0),R=b.EnumGenerator.create([{DeviceEvent:7},{ImageAcquired:2},{ImageAcquiring:1},{ImageAcquiringProgress:8},{None:0},{ScanCanceled:5},{ScanCompleted:3},{ScanFailed:4},{ScanFinished:9},{UserInterfaceClosed:6}],
!1),y=b.EnumGenerator.create([{CustomHalftone:2},{Diffusion:3},{Halftones:1},{Threshold:0}],!1),S=b.EnumGenerator.create([{Auto:0},{Clear:1},{NoClear:2}],!1),w=b.EnumGenerator.create([{None:0},{OnePass:1},{TwoPass:2}],!1),z=b.EnumGenerator.create([{Black:8},{Blue:2},{Cyan:5},{Green:1},{Magenta:6},{None:3},{Red:0},{White:4},{Yellow:7}],!1),A=b.EnumGenerator.create([{DetectAndExcludeJobSeparatorAndContinueScanning:3},{DetectAndExcludeJobSeparatorAndStopScanning:4},{DetectAndIncludeJobSeparatorAndContinueScanning:1},
{DetectAndIncludeJobSeparatorAndStopScanning:2},{None:0}],!1),B=b.EnumGenerator.create([{Reflective:0},{Transmissive:1}],!1),C=b.EnumGenerator.create([{Blue:2},{Green:1},{InfraRed:6},{None:3},{Red:0},{UltraViolet:5},{White:4}],!1),D=b.EnumGenerator.create([{Auto:1},{LonePixel:2},{MajorityRule:3},{None:0}],!1),E=b.EnumGenerator.create([{Auto:1},{Current:2},{None:0}],!1),F=b.EnumGenerator.create([{Auto:4},{AutoPicture:6},{AutoText:5},{Landscape:3},{Portrait:0},{Rotation180:2},{Rotation90:1}],!1),G=
b.EnumGenerator.create([{A0:19},{A0x2:18},{A0x4:17},{A1:20},{A10:25},{A2:21},{A3:11},{A4:1},{A5:5},{A6:13},{A7:22},{A8:23},{A9:24},{B3:12},{B4:6},{B5:2},{B6:7},{BUSINESSCARD:53},{C0:44},{C1:45},{C10:51},{C2:46},{C3:47},{C4:14},{C5:15},{C6:16},{C7:48},{C8:49},{C9:50},{ISOB0:26},{ISOB1:27},{ISOB10:33},{ISOB2:28},{ISOB3:12},{ISOB4:6},{ISOB5:29},{ISOB6:7},{ISOB7:30},{ISOB8:31},{ISOB9:32},{JISB0:34},{JISB1:35},{JISB10:43},{JISB2:36},{JISB3:37},{JISB4:38},{JISB6:39},{JISB7:40},{JISB8:41},{JISB9:42},{None:0},
{USEXECUTIVE:10},{USLEDGER:9},{USLEGAL:4},{USLETTER:3},{USSTATEMENT:52}],!1),H=b.EnumGenerator.create([{Chocolate:0},{Vanilla:1}],!1),I=b.EnumGenerator.create([{BGR:12},{BW:0},{CIELAB:13},{CIELUV:14},{CIEXYZ:8},{CMY:4},{CMYK:5},{Gray:1},{Infrared:16},{Lab:9},{Palette:3},{RGB:2},{SRGB:10},{SRGB64:11},{YCBCR:15},{YUV:6},{YUVK:7}],!1),J=b.EnumGenerator.create([{File:1},{Memory:2},{Native:0}],!1),K=b.EnumGenerator.create([{BitFields:12},{Group31D:2},{Group31DEol:3},{Group32D:4},{Group4:5},{Jbig:8},{Jpeg:6},
{Lzw:7},{None:0},{Packbits:1},{Png:9},{Rle4:10},{Rle8:11}],!1),L=b.EnumGenerator.create([{Bmp:2},{Dejavu:14},{EXIF:9},{FlashPix:5},{Jpeg:4},{Jpeg2000:11},{Jpeg2000JPN:12},{Jpeg2000JPX:13},{PDF:10},{PDFA:15},{Pict:1},{Png:7},{SamsungSrw:32770},{SPIFF:8},{Tiff:0},{TiffMulti:6},{XBM:3}],!1),T=b.EnumGenerator.create([{Array:3},{Enum:4},{OneValue:5},{Range:6},{Undefined:0}],!1),U=b.EnumGenerator.create([{Bool:6},{Fix32:7},{Frame:8},{Int16:1},{Int16Handle:44},{Int32:2},{Int8:0},{Str1024:13},{Str128:11},
{Str255:12},{Str32:9},{Str64:10},{UInt16:4},{UInt32:5},{UInt32Handle:43},{UInt8:3},{UInt8Handle:15},{Undefined:-1},{Uni512:14}],!1),M=b.EnumGenerator.create([{Centimeters:1},{Inches:0},{Millimeters:6},{Picas:2},{Pixels:5},{Points:3},{Twips:4}],!1),V=b.EnumGenerator.create([{XferCount:1},{ICompression:256},{IPixelType:257},{IUnits:258},{IXferMech:259},{Author:4096},{Caption:4097},{FeederEnabled:4098},{FeederLoaded:4099},{TimeDate:4100},{SupportedCaps:4101},{ExtendedCaps:4102},{AutoFeed:4103},{ClearPage:4104},
{FeedPage:4105},{RewindPage:4106},{Indicators:4107},{SupportedCapsExt:4108},{PaperDetectable:4109},{UIControllable:4110},{DeviceOnline:4111},{AutoScan:4112},{ThumbnailsEnabled:4113},{Duplex:4114},{DuplexEnabled:4115},{EnableDsUiOnly:4116},{CustomDsData:4117},{EndOrSer:4118},{JobControl:4119},{Alarms:4120},{AlarmVolume:4121},{AutomaticCapture:4122},{TimeBeforeFirstCapture:4123},{TimeBetweenCaptures:4124},{ClearBuffers:4125},{MaxBatchBuffers:4126},{DeviceTimeDate:4127},{PowerSupply:4128},{CameraPreviewUI:4129},
{DeviceEvents:4130},{SerialNumber:4132},{Printer:4134},{PrinterEnabled:4135},{PrinterIndex:4136},{PrinterMode:4137},{PrinterString:4138},{PrinterSuffix:4139},{Language:4140},{FeederAlignment:4141},{FeederOrder:4142},{ReacquireAllowed:4144},{BatteryMinutes:4146},{BatteryPercentage:4147},{CameraSide:4148},{Segmented:4149},{AutomaticSenseMedium:4155},{CameraEnabled:4150},{CameraOrder:4151},{MicrEnabled:4152},{FeederPrep:4153},{FeederPocket:4154},{CustomInterfaceGuid:4156},{SupportedCapsSegmentUnique:4157},
{SupportedDats:4158},{DoubleFeedDetection:4159},{DoubleFeedDetectionLength:4160},{DoubleFeedDetectionSensitivity:4161},{DoubleFeedDetectionResponse:4162},{PaperHandling:4163},{IndicatorsMode:4164},{PrinterVerticalOffset:4165},{PowerSaveTime:4166},{ISupportedExtImageInfo:4446},{IAutoBright:4352},{IBrightness:4353},{IContrast:4355},{ICustomHalftone:4356},{IExposureTime:4357},{IFilter:4358},{IFlashUsed:4359},{IGamma:4360},{IHalftones:4361},{IHighlight:4362},{IImageFileFormat:4364},{ILampState:4365},
{ILightSource:4366},{IOrientation:4368},{IPhysicalWidth:4369},{IPhysicalHeight:4370},{IShadow:4371},{IFrames:4372},{IXNativeResolution:4374},{IYNativeResolution:4375},{IXResolution:4376},{IYResolution:4377},{IMaxFrames:4378},{ITiles:4379},{IBitOrder:4380},{ICcittKFactor:4381},{ILightPath:4382},{IPixelFlavor:4383},{IPlanarChunky:4384},{IRotation:4385},{ISupportedSizes:4386},{IThreshold:4387},{IXScaling:4388},{IYScaling:4389},{IBitOrderCodes:4390},{IPixelFlavorCodes:4391},{IJpegPixelType:4392},{ITimeFill:4394},
{IBitDepth:4395},{IBitDepthReduction:4396},{IUndefinedImageSize:4397},{IImageDataSet:4398},{IExtImageInfo:4399},{IMinimumHeight:4400},{IMinimumWidth:4401},{IFlipRotation:4406},{IBarCodeDetectionEnabled:4407},{ISupportedBarCodeTypes:4408},{IBarCodeMaxSearchPriorities:4409},{IBarCodeSearchPriorities:4410},{IBarCodeSearchMode:4411},{IBarCodeMaxRetries:4412},{IBarCodeTimeout:4413},{IZoomFactor:4414},{IPatchCodeDetectionEnabled:4415},{ISupportedPatchCodeTypes:4416},{IPatchCodeMaxSearchPriorities:4417},
{IPatchCodeSearchPriorities:4418},{IPatchCodeSearchMode:4419},{IPatchCodeMaxRetries:4420},{IPatchCodeTimeout:4421},{IFlashUsed2:4422},{IImageFilter:4423},{INoiseFilter:4424},{IOverScan:4425},{IAutomaticBorderDetection:4432},{IAutomaticDeskew:4433},{IAutomaticRotate:4434},{IJpegQuality:4435},{IFeederType:4436},{IIccProfile:4437},{IAutoSize:4438},{IAutoDiscardBlankPages:4404},{IAutomaticCropUsesFrame:4439},{IAutomaticLengthDetection:4440},{IAutomaticColorEnabled:4441},{IAutomaticColorNonColorPixelType:4442},
{IColorManagementEnabled:4443},{IImageMerge:4444},{IImageMergeHeightThreshold:4445},{IFilmType:4447},{IMirror:4448},{IJpegSubsampling:4449},{PrinterCharRotation:4167},{PrinterFontStyle:4168},{PrinterIndexLeadChar:4169},{PrinterIndexMaxValue:4170},{PrinterIndexNumDigits:4171},{PrinterIndexStep:4172},{PrinterIndexTrigger:4173},{PrinterStringPreview:4174}],!1),W=b.EnumGenerator.create([{Afghanistan:1001},{Algeria:213},{Americansamoa:684},{Andorra:33},{Angola:1002},{Anguilla:8090},{Antigua:8091},{Argentina:54},
{Aruba:297},{Ascensioni:247},{Australia:61},{Austria:43},{Bahamas:8092},{Bahrain:973},{Bangladesh:880},{Barbados:8093},{Belgium:32},{Belize:501},{Benin:229},{Bermuda:8094},{Bhutan:1003},{Bolivia:591},{Botswana:267},{Britain:6},{Britvirginis:8095},{Brazil:55},{Brunei:673},{Bulgaria:359},{Burkinafaso:1004},{Burma:1005},{Burundi:1006},{Camaroon:237},{Canada:2},{Capeverdeis:238},{Caymanis:8096},{CentralAfRep:1007},{Chad:1008},{Chile:56},{China:86},{Christmasis:1009},{Cocosis:1009},{Colombia:57},{Comoros:1010},
{Congo:1011},{Cookis:1012},{Costarica:506},{Cuba:5},{Cyprus:357},{Czechoslovakia:42},{Denmark:45},{Djibouti:1013},{Dominica:8097},{Domincanrep:8098},{Easteris:1014},{Ecuador:593},{Egypt:20},{Elsalvador:503},{Eqguinea:1015},{Ethiopia:251},{Falklandis:1016},{Faeroeis:298},{FijiIslands:679},{Finland:358},{France:33},{Frantilles:596},{Frguiana:594},{Frpolyneisa:689},{Futanais:1043},{Gabon:241},{Gambia:220},{Germany:49},{Ghana:233},{Gibralter:350},{Greece:30},{Greenland:299},{Grenada:8099},{Grenedines:8015},
{Guadeloupe:590},{Guam:671},{Guantanamobay:5399},{Guatemala:502},{Guinea:224},{Guineabissau:1017},{Guyana:592},{Haiti:509},{Honduras:504},{Hongkong:852},{Hungary:36},{Iceland:354},{India:91},{Indonesia:62},{Iran:98},{Iraq:964},{Ireland:353},{Israel:972},{Italy:39},{Ivorycoast:225},{Jamaica:8010},{Japan:81},{Jordan:962},{Kenya:254},{Kiribati:1018},{Korea:82},{Kuwait:965},{Laos:1019},{Lebanon:1020},{Liberia:231},{Libya:218},{Liechtenstein:41},{Luxenbourg:352},{Macao:853},{Madagascar:1021},{Malawi:265},
{Malaysia:60},{Maldives:960},{Mali:1022},{Malta:356},{Marshallis:692},{Mauritania:1023},{Mauritius:230},{Mexico:3},{Micronesia:691},{Miquelon:508},{Monaco:33},{Mongolia:1024},{Montserrat:8011},{Morocco:212},{Mozambique:1025},{Namibia:264},{Nauru:1026},{Nepal:977},{Netherlands:31},{Nethantilles:599},{Nevis:8012},{Newcaledonia:687},{Newzealand:64},{Nicaragua:505},{Niger:227},{Nigeria:234},{Niue:1027},{Norfolki:1028},{Norway:47},{Oman:968},{Pakistan:92},{Palau:1029},{Panama:507},{Paraguay:595},{Peru:51},
{Phillippines:63},{Pitcairnis:1030},{Pnewguinea:675},{Poland:48},{Portugal:351},{Qatar:974},{Reunioni:1031},{Romania:40},{Rwanda:250},{Saipan:670},{Sanmarino:39},{Saotome:1033},{SaudiArabia:966},{Senegal:221},{Seychellesis:1034},{Sierraleone:1035},{Singapore:65},{Solomonis:1036},{Somali:1037},{SouthAfrica:27},{Spain:34},{Srilanka:94},{Sthelena:1032},{Stkitts:8013},{Stlucia:8014},{Stpierre:508},{Stvincent:8015},{Sudan:1038},{Suriname:597},{Swaziland:268},{Sweden:46},{Switzerland:41},{Syria:1039},{Taiwan:886},
{Tanzania:255},{Thailand:66},{Tobago:8016},{Togo:228},{Tongais:676},{Trinidad:8016},{Tunisia:216},{Turkey:90},{Turkscaicos:8017},{Tuvalu:1040},{Uganda:256},{UaEmirates:971},{UnitedKingdom:44},{Usa:1},{Uruguay:598},{Vanuatu:1041},{VaticanCity:39},{Venezuela:58},{Wake:1042},{Wallisis:1043},{WesternSahara:1044},{WesternSamoa:1045},{Yemen:1046},{Yugoslavia:38},{Zaire:243},{Zambia:260},{Zimbabwe:263},{Albania:355},{Armenia:374},{Azerbaijan:994},{Belarus:375},{Bosniaherzgo:387},{Cambodia:855},{Croatia:385},
{CzechRepublic:420},{Diegogarcia:246},{Eritrea:291},{Estonia:372},{Georgia:995},{Latvia:371},{Lesotho:266},{Lithuania:370},{Macedonia:389},{Mayotteis:269},{Moldova:373},{Myanmar:95},{NorthKorea:850},{Puertorico:787},{Russia:7},{Serbia:381},{Slovakia:421},{Slovenia:386},{SouthKorea:82},{Ukraine:380},{UsVirginis:340},{Vietnam:84}],!1),X=b.EnumGenerator.create([{UserLocale:-1},{Danish:0},{Dutch:1},{English:2},{FrenchCanadian:3},{Finnish:4},{French:5},{German:6},{Icelandic:7},{Italian:8},{Norwegian:9},
{Portuguese:10},{Spanish:11},{Swedish:12},{EnglishUsa:13},{Afrikaans:14},{Albania:15},{Arabic:16},{ArabicAlgeria:17},{ArabicBahrain:18},{ArabicEgypt:19},{ArabicIraq:20},{ArabicJordan:21},{ArabicKuwait:22},{ArabicLebanon:23},{ArabicLibya:24},{ArabicMorocco:25},{ArabicOman:26},{ArabicQatar:27},{ArabicSaudiArabia:28},{ArabicSyria:29},{ArabicTunisia:30},{ArabicUae:31},{ArabicYemen:32},{Basque:33},{Byelorussian:34},{Bulgarian:35},{Catalan:36},{Chinese:37},{ChineseHongkong:38},{ChinesePrc:39},{ChineseSingapore:40},
{ChineseSimplified:41},{ChineseTaiwan:42},{ChineseTraditional:43},{Croatia:44},{Czech:45},{DutchBelgian:46},{EnglishAustralian:47},{EnglishCanadian:48},{EnglishIreland:49},{EnglishNewZealand:50},{EnglishSouthAfrica:51},{EnglishUnitedKingdom:52},{Estonian:53},{Faeroese:54},{Farsi:55},{FrenchBelgian:56},{FrenchLuxembourg:57},{FrenchSwiss:58},{GermanAustrian:59},{GermanLuxembourg:60},{GermanLiechtenstein:61},{GermanSwiss:62},{Greek:63},{Hebrew:64},{Hungarian:65},{Indonesian:66},{ItalianSwiss:67},{Japanese:68},
{Korean:69},{KoreanJihab:70},{Latvian:71},{Lithuanian:72},{NorwegianBokmal:73},{NorwegianNynorsk:74},{Polish:75},{PortugueseBrazil:76},{Romanian:77},{Russian:78},{SerbianLatin:79},{Slovak:80},{Slovenian:81},{SpanishMexican:82},{SpanishModern:83},{Thai:84},{Turkish:85},{Ukrainian:86},{Assmese:87},{Bengali:88},{Bihari:89},{Bodo:90},{Dogri:91},{Gujarati:92},{Haryanvi:93},{Hindi:94},{Kannada:95},{Kashmiri:96},{Malayalam:97},{Marathi:98},{Marwari:99},{Meghalayan:100},{Mizo:101},{Naga:102},{Orissi:103},
{Punjabi:104},{Pushtu:105},{SerbianCyrillic:106},{Sikkimi:107},{SwedishFinland:108},{Tamil:109},{Telugu:110},{Tripuri:111},{Urdu:112},{Vietnamese:113}],!1),x=function(a,n,e,Y){var k=x.prototype;k.get_Left=function(){return this._569};k.set_Left=function(a){b.pv.n(a);this._569=a};k.get_Top=function(){return this._141};k.set_Top=function(a){b.pv.n(a);this._141=a};k.get_Right=function(){return this._580};k.set_Right=function(a){b.pv.n(a);this._580=a};k.get_Bottom=function(){return this._578};k.set_Bottom=
function(a){b.pv.n(a);this._578=a};k.equals=function(a){return b.pv.ic(a,x)?this._569===a._569&&this._141===a._141&&this._580===a._580&&this._578===a._578:!1};k.toRectangle=function(){return{x:this._569,y:this._141,width:this._580-this._569,height:this._578-this._141}};k.toString=function(){return"("+this._569+"; "+this._141+") - ("+this._580+"; "+this._578+")"};b.pv.n(a,n,e,Y);this._569=a;this._141=n;this._580=e;this._578=Y},s=function(){var a=s.prototype;a.get_IsTwain2Compatible=function(){return this._498};
a.set_IsTwain2Compatible=function(a){b.pv.b(a);this._498=a};a.get_CountryCode=function(){return this._413};a.set_CountryCode=function(a){this._413=b.pv.e(a,e.WebCountryCodeEnumJS)};a.get_LanguageType=function(){return this._187};a.set_LanguageType=function(a){b.pv.e(a,e.WebLanguageTypeEnumJS);this._187=a};a.get_ApplicationProductName=function(){return this._481};a.set_ApplicationProductName=function(a){b.pv.s(a);this._481=a};a.get_TopMostUiWindow=function(){return this._666};a.set_TopMostUiWindow=
function(a){b.pv.b(a);this._666=a};a.get_AllowableSessionInactivityTime=function(){return this._320};a.set_AllowableSessionInactivityTime=function(a){b.pv.n(a);(100>a||36E5<a)&&pv.toe();this._320=a};this._498=!0;this._413=new W(1);this._187=new X(2);this._481="VintaSoft Twain";this._666=!0;this._320=6E4};b.WebServiceJS.defaultTwainService=-1;var N=function(a){function e(a){!1===a._728&&b.pv.te("Device manager is not open.")}function m(){b.pv.te("Information about TWAIN devices is not available, call the requestDevices method.")}
null==a&&(a=b.WebServiceJS.defaultTwainService);b.pv.c(a,b.WebServiceJS,"You should specify correct TWAIN service OR define the default TWAIN service.");this._794=a;this._333=this._514=this._438=this._339=this._788=this._765=null;this._498=this._728=!1;a=N.prototype;a.get_IsOpened=function(){return this._728};a.get_IsTwain2Compatible=function(){return this._498};a.get_OpenedDevice=function(){return this._514};a.get_TwainServiceVersion=function(){return this._765};a.get_TwainSessionId=function(){return this._788};
a.open=function(a,k,e){function f(){var a=g,k=new b.WebRequestJS("RefreshTwainSession",null,null,{data:{twainSessionId:a._788}});a._794.sendRequest(k)}b.pv.isf(a)&&(e=k,k=a,a=new s);b.pv.c(a,s);var g=this,n=new b.WebRequestJS("CreateTwainSession",function(n,m,P){g._765=n.serviceVersion;g._788=n.sessionId;g._339=setInterval(f,a._320);n=new b.WebRequestJS("OpenDeviceManager",function(b,e,f){g._728=!0;g._498=a._498;null!=k&&k(b,e,f)},e,{data:{twainSessionId:g._788,isTwain2Compatible:a._498,applicationProductName:a._481,
topMostUiWindow:a._666}});return g._794.sendRequest(n)},e,{data:{countryCode:a._413.valueOf(),languageType:a._187.valueOf()}});return this._794.sendRequest(n)};a.close=function(a,k){e(this);var l=this,f=new b.WebRequestJS("CloseTwainSession",function(b,k,e){l._728=!1;l._765=null;l._788=null;l._438=null;l._514=null;l._333=null;null!=a&&a(b,k,e)},k,{data:{twainSessionId:this._788}});null!=this._339&&(clearInterval(this._339),this._339=null);return this._794.sendRequest(f)};a.getDevices=function(){if(null!=
this._438)return this._438.slice();m()};a.isDevicesReceived=function(){return null!=this._438};a.getDefaultDevice=function(){if(null!=this._438)return this._333;m()};a.requestDevices=function(a,k){e(this);null!=this._438&&b.pv.te("Information about devices already received. If you want refresh it - close and reopen DeviceManager and send new request.");var l=this,f=new b.WebRequestJS("GetDeviceInfos",function(b,k,e){var f=b.devices;b=b.defaultDeviceIndex;for(var n=[],m=0;m<f.length;m++){var p=f[m],
p=new t(p.productName,p.productFamily,p.manufacturer,p.driverVersion,p.twainVersion,l);n.push(p)}if(null!=l._438)for(m=0;m<l._438.length;){f=l._438[m];for(p=0;p<n.length;p++)if(f._799===n[p]._799){n[p]=f;break}l._438.splice(m,1)}l._438=n;l._333=n[b];b={devices:l._438.slice(),defaultDevice:l._333};null!=a&&a(b,k,e)},k,{data:{twainSessionId:this._788}});this._794.sendRequest(f)}},Q=function(a){function e(a,b,l,f){a._123.getCapability(b,1,function(a){a=a.capability.value.value;l&&l({value:a})},f)}function m(a,
b,e,f,g){a._123.setCapability(b,e.toString(),function(a){f&&f()},g)}b.pv.c(a,t);this._123=a;a=Q.prototype;a.getEnabled=function(a,b){e(this,4098,a,b)};a.setEnabled=function(a,e,l){b.pv.b(a);m(this,4098,a,e,l)};a.getPaperDetectable=function(a,b){e(this,4109,a,b)};a.getLoaded=function(a,b){e(this,4099,a,b)};a.getDuplexMode=function(a,b){e(this,4114,a,b)};a.getDuplexEnabled=function(a,b){e(this,4115,a,b)};a.setDuplexEnabled=function(a,e,l){b.pv.b(a);m(this,4115,a,e,l)};a.getAutoFeed=function(a,b){e(this,
4103,a,b)};a.setAutoFeed=function(a,e,l){b.pv.b(a);m(this,4103,a,e,l)};a.feedPage=function(a,b){m(this,4105,!0,a,b)};a.clearPage=function(a,b){m(this,4104,!0,a,b)};a.rewindPage=function(a,b){m(this,4106,!0,a,b)}},t=function(a,e,m,r,k,l){function f(h,a,b,e){h.getCapability(a,1,function(h){h=h.capability.value;delete h.containerType;delete h.valueType;delete h.defaultValue;b&&b(h)},e)}function g(h,a,d,e,f){b.pv.ic(d,b.WebEnumItemBase)&&(d=d.valueOf());h.setCapability(a,d.toString(),function(h){e&&e()},
f)}function s(h){var a=h.id;null!=h.value&&O(a,h.value);null!=h.currentValue&&O(a,h.currentValue);null!=h.defaultValue&&O(a,h.defaultValue)}function O(h,a){try{a.containerType=b.pv.e(a.containerType,T);a.valueType=b.pv.e(a.valueType,U);var d=a.containerType.valueOf(),e=a.valueType.valueOf();if(0!==d)if(6===d)u(a,P);else{var f=t._586[h];if(null!=f)u(a,function(a){var h=a;try{h=b.pv.e(a,f)}catch(c){}return h});else switch(e){case 6:u(a,w);break;case 7:case 1:case 44:case 2:case 0:case 4:case 5:case 43:case 3:case 15:u(a,
P);break;case 8:u(a,p)}}}catch(g){}}function u(a,c){null!=a.value&&(a.value=c(a.value));null!=a.defaultValue&&(a.defaultValue=c(a.defaultValue));a.minValue&&(a.minValue=c(a.minValue));a.maxValue&&(a.maxValue=c(a.maxValue));a.stepSize&&(a.stepSize=c(a.stepSize));var b=a.supportedValues;if(null!=b){for(var e=[],f=0;f<b.length;f++)e[f]=c(b[f]);a.supportedValues=e}}function P(a){return+a}function w(a){return"True"===a}function p(a){var b=a.match(/\((.*); (.*)\) - \((.*); (.*)\)/);if(5==b.length){for(var d=
[],e=1;e<b.length;e++)d.push(+b[e]);if(4===d.length)try{return new x(d[0],d[1],d[2],d[3])}catch(f){}}return a}function q(a){a._491._514==a&&a._728||b.pv.te("Device is not opened.")}b.pv.c(l,N);b.pv.s(a,e,m,r,k);this._491=l;this._728=!1;this._799=a;this._342=e;this._316=m;this._235=r;this._572=k;this._584=this._214=this._323=null;a=t.prototype;a.get_IsOpened=function(){return this._728};a.get_DeviceName=function(){return this._799};a.get_ProductFamily=function(){return this._342};a.get_Manufacturer=
function(){return this._316};a.get_DeviceName=function(){return this._799};a.get_DriverVersion=function(){return this._235};a.get_TwainVersion=function(){return this._572};a.get_IsTwain2Compatible=function(){return 2<=this._572};a.get_IsWIA=function(){return this._799.startsWith?this._799.startsWith("WIA - "):0===this._799.search("WIA - ")};a.get_HasFeeder=function(){q(this);return this._323};a.get_HasFlatbed=function(){q(this);return this._214};a.get_DocumentFeeder=function(){this.get_HasFeeder()||
b.pv.te("Document feeder is not found.");null==this._584&&(this._584=new Q(this));return this._584};a.open=function(a,c,d){null!=this._491._514&&b.pv.te("Another device '"+this._491._514._799+"' is opened already.");b.pv.b(a);var e=this;a=new b.WebRequestJS("OpenDevice",function(a,h,b){e._491._514=e;e._323=a.hasFeeder;e._214=a.hasFlatbed;e._728=!0;null!=c&&c(a,h,b)},d,{data:{deviceName:this._799,twainSessionId:this._491._788,showUI:a}});return this._491._794.sendRequest(a)};a.close=function(a,c){q(this);
var d=this,e=new b.WebRequestJS("CloseDevice",function(b,c,e){d._491._514=null;d._728=!1;null!=a&&a(b,c,e)},c,{data:{twainSessionId:this._491._788}});return this._491._794.sendRequest(e)};a.acquireModal=function(a,c){q(this);var d=new b.WebRequestJS("AcquireModal",function(c){var d=b.pv.e(c.acquireModalState,R);c.acquireModalState=d;a&&a(c)},c,{data:{twainSessionId:this._491._788,deviceName:this._799}});return this._491._794.sendRequest(d)};a.cancelTransfer=function(a,c){q(this);var d=new b.WebRequestJS("CancelTransfer",
a,c,{data:{twainSessionId:this._491._788,deviceName:this._799}});return this._491._794.sendRequest(d)};a.getSupportedCapabilities=function(a,c,d){q(this);a=b.pv.e(a,v);a=new b.WebRequestJS("GetSupportedDeviceCapabilities",function(a){for(var h=0;h<a.capabilities.length;h++)s(a.capabilities[h]);c&&c(a)},d,{data:{twainSessionId:this._491._788,usageMode:a.valueOf(),deviceName:this._799}});return this._491._794.sendRequest(a)};a.getCapability=function(a,c,d,e){q(this);c=b.pv.e(c,v);a=b.pv.ic(a,b.WebEnumItemBase)?
a.valueOf():a;b.pv.n(a);a=new b.WebRequestJS("GetDeviceCapability",function(a){s(a.capability);d&&d(a)},e,{data:{twainSessionId:this._491._788,capabilityId:a,usageMode:c.valueOf(),deviceName:this._799}});return this._491._794.sendRequest(a)};a.getCapabilities=function(a,c,d,e){q(this);c=b.pv.e(c,v);var f=[];b.pv.ad(a,function(a){a=b.pv.ic(a,b.WebEnumItemBase)?a.valueOf():a;b.pv.n(a);f.push(a)});a=new b.WebRequestJS("GetDeviceCapabilities",function(a){for(var h=0;h<a.capabilities.length;h++)s(a.capabilities[h]);
d&&d(a)},e,{data:{twainSessionId:this._491._788,capabilitiesId:f,usageMode:c.valueOf(),deviceName:this._799}});return this._491._794.sendRequest(a)};a.setCapability=function(a,c,d,e){q(this);a=b.pv.ic(a,b.WebEnumItemBase)?a.valueOf():a;b.pv.n(a);b.pv.ic(c,b.WebEnumItemBase)&&(c=c.valueOf());a=new b.WebRequestJS("SetDeviceCapability",function(a){s(a.capability);d&&d(a)},e,{data:{twainSessionId:this._491._788,capabilityId:a,capabilityValue:c,deviceName:this._799}});return this._491._794.sendRequest(a)};
a.getDefaultImageLayout=function(a,c){q(this);var d=new b.WebRequestJS("GetDefaultDeviceImageLayout",a,c,{data:{twainSessionId:this._491._788,deviceName:this._799,documentNumber:1,frameNumber:1,pageNumber:1}});return this._491._794.sendRequest(d)};a.getImageLayout=function(a,c){q(this);var d=new b.WebRequestJS("GetDeviceImageLayout",a,c,{data:{twainSessionId:this._491._788,deviceName:this._799,documentNumber:1,frameNumber:1,pageNumber:1}});return this._491._794.sendRequest(d)};a.resetImageLayout=
function(a,c){q(this);var d=new b.WebRequestJS("ResetDeviceImageLayout",a,c,{data:{twainSessionId:this._491._788,deviceName:this._799,documentNumber:1,frameNumber:1,pageNumber:1}});return this._491._794.sendRequest(d)};a.setImageLayout=function(a,c,d){q(this);b.pv.r(a);a=new b.WebRequestJS("SetDeviceImageLayout",c,d,{data:{twainSessionId:this._491._788,deviceName:this._799,documentNumber:1,frameNumber:1,pageNumber:1,frame:a}});return this._491._794.sendRequest(a)};a.getAutoBright=function(a,b){f(this,
4352,a,b)};a.setAutoBright=function(a,c,d){b.pv.b(a);g(this,4352,a,c,d)};a.getAutoScan=function(a,b){f(this,4112,a,b)};a.setAutoScan=function(a,c,d){b.pv.b(a);g(this,4112,a,c,d)};a.getBitDepth=function(a,b){f(this,4395,a,b)};a.setBitDepth=function(a,c,d){b.pv.n(a);g(this,4395,a,c,d)};a.getBitDepthReductionMode=function(a,b){f(this,4396,a,b)};a.setBitDepthReductionMode=function(a,c,d){a=b.pv.e(a,y);g(this,4396,a,c,d)};a.getBrightness=function(a,b){f(this,4353,a,b)};a.setBrightness=function(a,c,d){b.pv.n(a);
g(this,4353,a,c,d)};a.getBufferedImageCount=function(a,b){f(this,4125,a,b)};a.setClearBuffers=function(a,c,d){a=b.pv.e(a,S);g(this,4125,a,c,d)};a.getContrast=function(a,b){f(this,4355,a,b)};a.setContrast=function(a,c,d){b.pv.n(a);g(this,4355,a,c,d)};a.getFileFormat=function(a,b){f(this,4364,a,b)};a.setFileFormat=function(a,c,d){a=b.pv.e(a,L);g(this,4364,a,c,d)};a.getFileJpegQuality=function(a,b){f(this,4435,a,b)};a.setFileJpegQuality=function(a,c,d){b.pv.n(a);g(this,4435,a,c,d)};a.getHalftones=function(a,
b){f(this,4361,a,b)};a.setHalftones=function(a,c,d){b.pv.s(a);g(this,4361,a,c,d)};a.getImageCompression=function(a,b){f(this,256,a,b)};a.setImageCompression=function(a,c,d){a=b.pv.e(a,K);g(this,256,a,c,d)};a.getImageFilter=function(a,b){f(this,4358,a,b)};a.setImageFilter=function(a,c,d){a=b.pv.e(a,z);g(this,4358,a,c,d)};a.getJobControl=function(a,b){f(this,4119,a,b)};a.setJobControl=function(a,c,d){a=b.pv.e(a,A);g(this,4119,a,c,d)};a.getLampState=function(a,b){f(this,4365,a,b)};a.setLampState=function(a,
c,d){b.pv.b(a);g(this,4365,a,c,d)};a.getLightPath=function(a,b){f(this,4382,a,b)};a.setLightPath=function(a,c,d){a=b.pv.e(a,B);g(this,4382,a,c,d)};a.getLightSource=function(a,b){f(this,4366,a,b)};a.setLightSource=function(a,c,d){a=b.pv.e(a,C);g(this,4366,a,c,d)};a.getMaxBatchBuffers=function(a,b){f(this,4126,a,b)};a.setMaxBatchBuffers=function(a,c,d){b.pv.n(a);g(this,4126,a,c,d)};a.getNoiseFilter=function(a,b){f(this,4424,a,b)};a.setNoiseFilter=function(a,c,d){a=b.pv.e(a,D);g(this,4424,a,c,d)};a.getOnline=
function(a,b){f(this,4111,a,b)};a.getPageAutoSize=function(a,b){f(this,4438,a,b)};a.setPageAutoSize=function(a,c,d){a=b.pv.e(a,E);g(this,4438,a,c,d)};a.getPageOrientation=function(a,b){f(this,4368,a,b)};a.setPageOrientation=function(a,c,d){a=b.pv.e(a,F);g(this,4368,a,c,d)};a.getPageSize=function(a,b){f(this,4386,a,b)};a.setPageSize=function(a,c,d){a=b.pv.e(a,G);g(this,4386,a,c,d)};a.getPixelFlavor=function(a,b){f(this,4383,a,b)};a.setPixelFlavor=function(a,c,d){a=b.pv.e(a,H);g(this,4383,a,c,d)};a.getPixelType=
function(a,b){f(this,257,a,b)};a.setPixelType=function(a,c,d){a=b.pv.e(a,I);g(this,257,a,c,d)};a.getXResolution=function(a,b){f(this,4376,a,b)};a.setXResolution=function(a,c,d){b.pv.n(a);g(this,4376,a,c,d)};a.getYResolution=function(a,b){f(this,4377,a,b)};a.setYResolution=function(a,c,d){b.pv.n(a);g(this,4377,a,c,d)};a.getThreshold=function(a,b){f(this,4387,a,b)};a.setThreshold=function(a,c,d){b.pv.n(a);g(this,4387,a,c,d)};a.getTransferMode=function(a,b){f(this,259,a,b)};a.setTransferMode=function(a,
c,d){a=b.pv.e(a,J);g(this,259,a,c,d)};a.getUnitOfMeasure=function(a,b){f(this,258,a,b)};a.setUnitOfMeasure=function(a,c,d){a=b.pv.e(a,M);g(this,258,a,c,d)};a.getXferCount=function(a,b){f(this,1,a,b)};a.setXferCount=function(a,c,d){b.pv.n(a);g(this,1,a,c,d)}};t._586=[];(function(){var a=t._586;a[4396]=y;a[4364]=L;a[256]=K;a[4358]=z;a[4119]=A;a[4382]=B;a[4366]=C;a[4424]=D;a[4438]=E;a[4368]=F;a[4386]=G;a[4383]=H;a[257]=I;a[259]=J;a[258]=M;a[4101]=V;a[4114]=w})();e.WebTwainDeviceCapabilityUsageModeEnumJS=
v;e.WebAcquireModalStateEnumJS=R;e.WebBitDepthReductionModeEnumJS=y;e.WebClearBufferModeEnumJS=S;e.WebDuplexModeEnumJS=w;e.WebImageFilterEnumJS=z;e.WebJobControlEnumJS=A;e.WebLightPathEnumJS=B;e.WebLightSourceEnumJS=C;e.WebNoiseFilterEnumJS=D;e.WebPageAutoSizeEnumJS=E;e.WebPageOrientationEnumJS=F;e.WebPageSizeEnumJS=G;e.WebPixelFlavorEnumJS=H;e.WebPixelTypeEnumJS=I;e.WebTransferModeEnumJS=J;e.WebTwainImageCompressionEnumJS=K;e.WebTwainImageFileFormatEnumJS=L;e.WebTwainValueContainerTypeEnumJS=T;e.WebTwainValueTypeEnumJS=
U;e.WebUnitOfMeasureEnumJS=M;e.WebDeviceCapabilityIdEnumJS=V;e.WebCountryCodeEnumJS=W;e.WebLanguageTypeEnumJS=X;e.WebTwainFrameJS=x;e.WebTwainDeviceManagerInitSettingsJS=s;e.WebTwainDeviceManagerJS=N;e.WebTwainDeviceDocumentFeederJS=Q;e.WebTwainDeviceJS=t})(r.Twain||(r.Twain={}))})(Vintasoft||(Vintasoft={}));
